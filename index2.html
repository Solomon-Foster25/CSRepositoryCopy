<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Asteroids — Single Page with Powerups</title>
  <style>
    :root{ --bg:#0b0f14; --fg:#e8f0fe; --accent:#68d391; --muted:#9aa0a6; --danger:#ff6b6b; }
    html,body{height:100%;margin:0}
    body{font-family:sans-serif;background:var(--bg);color:var(--fg);overflow:hidden}
    #game{position:fixed;inset:0;background:radial-gradient(1200px 800px at 50% 40%,#121826 0%,#0b0f14 60%,#070a0f 100%)}
    .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6)}
    .panel{background:rgba(10,14,20,.9);padding:32px;border-radius:20px;text-align:center}
    h1{margin:0;color:var(--fg)}
    h2{margin:0 0 1rem;color:var(--muted)}
    .btn{padding:12px 18px;border:none;border-radius:14px;background:var(--accent);color:#000;font-weight:bold;cursor:pointer}
  </style>
</head>
<body>
  <canvas id="game"></canvas>
  <div id="hud" style="position:fixed;top:10px;left:10px;font-weight:bold">Score: <span id="score">0</span> Lives: <span id="lives">3</span> Level: <span id="level">1</span></div>
  <div class="overlay" id="splash"><div class="panel"><h1>ASTEROIDS</h1><h2>with Powerups</h2><button id="startBtn" class="btn">▶ Start</button></div></div>
  <div class="overlay" id="pauseOverlay" style="display:none"><div class="panel"><h1>Paused</h1><button id="resumeBtn" class="btn">Resume</button><button id="restartBtn" class="btn">Restart</button></div></div>

<script>
(()=>{
  const canvas=document.getElementById('game');
  const ctx=canvas.getContext('2d');
  const scoreEl=document.getElementById('score');
  const livesEl=document.getElementById('lives');
  const levelEl=document.getElementById('level');
  const splash=document.getElementById('splash');
  const startBtn=document.getElementById('startBtn');
  const pauseOverlay=document.getElementById('pauseOverlay');
  const resumeBtn=document.getElementById('resumeBtn');
  const restartBtn=document.getElementById('restartBtn');

  const rand=(a,b)=>Math.random()*(b-a)+a; const TAU=Math.PI*2;
  function fit(){canvas.width=innerWidth;canvas.height=innerHeight;} window.onresize=fit; fit();

  const State={SPLASH:0,PLAYING:1,PAUSED:2,GAMEOVER:3}; let state=State.SPLASH;
  const game={score:0,lives:3,level:1,ship:null,bullets:[],asteroids:[],powerups:[],lastShot:0,rapid:0,shield:0};

  function makeShip(){return{x:canvas.width/2,y:canvas.height/2,vx:0,vy:0,angle:-Math.PI/2,thrust:false,radius:14,inv:0};}
  function makeAst(x,y,size=3){const sp={1:120,2:80,3:60}[size];const a=Math.random()*TAU;const r={1:16,2:28,3:46}[size];const pts=Array.from({length:8+(Math.random()*4|0)},(_,i)=>{const ang=i/8*TAU+rand(-.1,.1);return{a:ang,rad:r*rand(.7,1.2)};});return{x,y,vx:Math.cos(a)*rand(sp/2,sp),vy:Math.sin(a)*rand(sp/2,sp),angle:0,spin:rand(-1,1),size,radius:r,pts};}
  function makeBullet(x,y,a,s){const sp=360;return{x,y,vx:Math.cos(a)*sp+s.vx,vy:Math.sin(a)*sp+s.vy,life:0,max:.9,r:2};}
  function makePower(x,y){const t=['life','rapid','shield'][Math.random()*3|0];return{x,y,type:t,radius:12,vx:rand(-40,40),vy:rand(-40,40),life:8};}

  function reset(){game.score=0;game.lives=3;game.level=1;game.bullets=[];game.asteroids=[];game.powerups=[];game.ship=makeShip();spawnWave();updateHUD();}
  function spawnWave(){for(let i=0;i<3+game.level;i++){const x=Math.random()<.5?Math.random()*canvas.width:(Math.random()<.5?-40:canvas.width+40);const y=Math.random()<.5?(Math.random()<.5?-40:canvas.height+40):Math.random()*canvas.height;game.asteroids.push(makeAst(x,y,3));}}
  function updateHUD(){scoreEl.textContent=game.score;livesEl.textContent=game.lives;levelEl.textContent=game.level;}

  const keys=new Set();
  onkeydown=e=>{if(e.key==='p')togglePause();else if(state===State.SPLASH&&(e.key==='Enter'||e.key===' '))start();keys.add(e.key)};
  onkeyup=e=>keys.delete(e.key);

  function start(){splash.style.display='none';pauseOverlay.style.display='none';reset();state=State.PLAYING;}
  function pause(){if(state!==State.PLAYING)return;state=State.PAUSED;pauseOverlay.style.display='flex';}
  function resume(){if(state!==State.PAUSED)return;state=State.PLAYING;pauseOverlay.style.display='none';}
  function togglePause(){state===State.PLAYING?pause():state===State.PAUSED?resume():0;}
  startBtn.onclick=start; resumeBtn.onclick=resume; restartBtn.onclick=()=>start(true);

  function wrap(o){if(o.x<-50)o.x=canvas.width+50;else if(o.x>canvas.width+50)o.x=-50;if(o.y<-50)o.y=canvas.height+50;else if(o.y>canvas.height+50)o.y=-50;}

  function drawShip(s){ctx.save();ctx.translate(s.x,s.y);ctx.rotate(s.angle);ctx.strokeStyle='#cde1ff';ctx.beginPath();ctx.moveTo(16,0);ctx.lineTo(-12,-10);ctx.lineTo(-6,-6);ctx.lineTo(-12,10);ctx.closePath();ctx.stroke();if(s.thrust){ctx.beginPath();ctx.moveTo(-12,0);ctx.lineTo(-22,0);ctx.strokeStyle='#68d391';ctx.stroke();}if(s.inv>0||game.shield>0){ctx.beginPath();ctx.arc(0,0,s.radius+6,0,TAU);ctx.strokeStyle='rgba(104,211,145,.5)';ctx.stroke();}ctx.restore();}
  function drawAst(a){ctx.save();ctx.translate(a.x,a.y);ctx.rotate(a.angle);ctx.strokeStyle='#9fb3d9';ctx.beginPath();a.pts.forEach((p,i)=>{const x=Math.cos(p.a)*p.rad;const y=Math.sin(p.a)*p.rad;i?ctx.lineTo(x,y):ctx.moveTo(x,y)});ctx.closePath();ctx.stroke();ctx.restore();}
  function drawB(b){ctx.beginPath();ctx.arc(b.x,b.y,2,0,TAU);ctx.fillStyle='#fff';ctx.fill();}
  function drawP(p){ctx.beginPath();ctx.arc(p.x,p.y,p.radius,0,TAU);ctx.fillStyle=p.type==='life'?'#0f0':p.type==='rapid'?'#0ff':'#ff0';ctx.fill();}

  function hit(a,b){const dx=a.x-b.x,dy=a.y-b.y;const r=(a.radius||a.r||0)+(b.radius||b.r||0);return dx*dx+dy*dy<=r*r;}

  let last=performance.now();
  function loop(now){requestAnimationFrame(loop);const dt=Math.min((now-last)/1000,.033);last=now;ctx.clearRect(0,0,canvas.width,canvas.height);
    if(state===State.PLAYING){const s=game.ship;s.thrust=keys.has('ArrowUp');if(keys.has('ArrowLeft'))s.angle-=3*dt;if(keys.has('ArrowRight'))s.angle+=3*dt;if(s.thrust){s.vx+=Math.cos(s.angle)*200*dt;s.vy+=Math.sin(s.angle)*200*dt;}s.vx*=.995;s.vy*=.995;s.x+=s.vx*dt;s.y+=s.vy*dt;wrap(s);if(s.inv>0)s.inv-=dt;if(game.rapid>0)game.rapid-=dt;if(game.shield>0)game.shield-=dt;
      const delay=game.rapid>0?70:140;if(keys.has(' ')&&now-game.lastShot>delay){game.bullets.push(makeBullet(s.x+Math.cos(s.angle)*16,s.y+Math.sin(s.angle)*16,s.angle,s));game.lastShot=now;}
      for(let i=game.bullets.length-1;i>=0;i--){const b=game.bullets[i];b.life+=dt;if(b.life>b.max){game.bullets.splice(i,1);continue;}b.x+=b.vx*dt;b.y+=b.vy*dt;wrap(b);drawB(b);}
      if(game.asteroids.length===0){game.level++;spawnWave();updateHUD();}
      for(const a of game.asteroids){a.x+=a.vx*dt;a.y+=a.vy*dt;a.angle+=a.spin*dt;wrap(a);drawAst(a);}
      for(let i=game.asteroids.length-1;i>=0;i--){const a=game.asteroids[i];for(let j=game.bullets.length-1;j>=0;j--){const b=game.bullets[j];if(hit(a,b)){game.bullets.splice(j,1);game.asteroids.splice(i,1);if(Math.random()<0.2)game.powerups.push(makePower(a.x,a.y));game.score+=20;updateHUD();break;}}}
      if(s.inv<=0&&game.shield<=0){for(const a of game.asteroids){if(hit(a,s)){game.lives--;updateHUD();if(game.lives<=0){state=State.GAMEOVER;splash.style.display='flex';splash.querySelector('h2').textContent='Game Over — Score: '+game.score;}else{game.ship=makeShip();game.ship.inv=2.2;}break;}}}
      for(let i=game.powerups.length-1;i>=0;i--){const p=game.powerups[i];p.x+=p.vx*dt;p.y+=p.vy*dt;p.life-=dt;wrap(p);drawP(p);if(p.life<=0)game.powerups.splice(i,1);else if(hit(p,s)){if(p.type==='life')game.lives++;if(p.type==='rapid')game.rapid=6;if(p.type==='shield')game.shield=6;updateHUD();game.powerups.splice(i,1);}}
      drawShip(s);
    }
  }
  requestAnimationFrame(loop);
})();
</script>
</body>
</html>
