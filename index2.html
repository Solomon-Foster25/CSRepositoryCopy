<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Asteroids â€” Single Page with Powerups</title>
  <style>
    body { margin:0; background:#000; color:#fff; font-family:sans-serif; overflow:hidden; }
    #game { position:fixed; inset:0; background:#000; }
    .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);color:#fff;}
    #hud{position:fixed;top:10px;left:10px;font-weight:bold;}
  </style>
</head>
<body>
  <canvas id="game"></canvas>
  <div id="hud">Score: <span id="score">0</span> Lives: <span id="lives">3</span> Level: <span id="level">1</span></div>
  <div class="overlay" id="splash"><div><h1>ASTEROIDS</h1><button id="startBtn">Start</button></div></div>
  <div class="overlay" id="pauseOverlay" style="display:none"><div><h1>Paused</h1><button id="resumeBtn">Resume</button></div></div>
  <script>
  (()=>{
    const canvas=document.getElementById('game'),ctx=canvas.getContext('2d');
    function fit(){canvas.width=innerWidth;canvas.height=innerHeight;}fit();addEventListener('resize',fit);

    const hud={score:document.getElementById('score'),lives:document.getElementById('lives'),level:document.getElementById('level')};
    const splash=document.getElementById('splash');
    const startBtn=document.getElementById('startBtn');
    const pauseOverlay=document.getElementById('pauseOverlay');
    const resumeBtn=document.getElementById('resumeBtn');

    let state='splash';
    let keys=new Set();
    let game;

    const TAU=Math.PI*2;

    function makeShip(){return {x:canvas.width/2,y:canvas.height/2,vx:0,vy:0,angle:-Math.PI/2,radius:14,invincible:0,rapid:0,shield:0};}
    function makeAsteroid(x,y,size=3){const r={1:16,2:28,3:46}[size];return{x,y,vx:(Math.random()*2-1)*60,vy:(Math.random()*2-1)*60,size,radius:r};}
    function makeBullet(x,y,a,s){const sp=300;return{x,y,vx:Math.cos(a)*sp+s.vx,vy:Math.sin(a)*sp+s.vy,life:0,maxLife:1,radius:2};}
    function makePowerup(x,y,type){return{x,y,type,radius:12,vx:(Math.random()*2-1)*40,vy:(Math.random()*2-1)*40,life:8};}

    function reset(){game={score:0,lives:3,level:1,ship:makeShip(),bullets:[],asteroids:[],powerups:[]};spawnWave();updateHUD();}
    function updateHUD(){hud.score.textContent=game.score;hud.lives.textContent=game.lives;hud.level.textContent=game.level;}
    function spawnWave(){for(let i=0;i<3+game.level;i++){game.asteroids.push(makeAsteroid(Math.random()*canvas.width,Math.random()*canvas.height,3));}}

    function start(){splash.style.display='none';pauseOverlay.style.display='none';reset();state='playing';}
    function pause(){if(state==='playing'){state='paused';pauseOverlay.style.display='flex';}}
    function resume(){if(state==='paused'){state='playing';pauseOverlay.style.display='none';}}

    startBtn.onclick=start;resumeBtn.onclick=resume;
    onkeydown=e=>{if(e.key==='p')togglePause();keys.add(e.key);};
    onkeyup=e=>keys.delete(e.key);
    function togglePause(){state==='playing'?pause():resume();}

    function wrap(o){if(o.x<0)o.x+=canvas.width;if(o.x>canvas.width)o.x-=canvas.width;if(o.y<0)o.y+=canvas.height;if(o.y>canvas.height)o.y-=canvas.height;}

    function loop(t){requestAnimationFrame(loop);
      ctx.clearRect(0,0,canvas.width,canvas.height);
      if(state==='playing'){
        let s=game.ship;
        if(keys.has('ArrowLeft'))s.angle-=0.08;
        if(keys.has('ArrowRight'))s.angle+=0.08;
        if(keys.has('ArrowUp')){s.vx+=Math.cos(s.angle)*0.2;s.vy+=Math.sin(s.angle)*0.2;}
        s.x+=s.vx;s.y+=s.vy;wrap(s);
        if(s.invincible>0)s.invincible-=0.016;
        if(s.rapid>0)s.rapid-=0.016;
        if(s.shield>0)s.shield-=0.016;
        if(keys.has(' ')){
          if(!s.lastShot||t-s.lastShot>(s.rapid>0?100:250)){
            game.bullets.push(makeBullet(s.x+Math.cos(s.angle)*16,s.y+Math.sin(s.angle)*16,s.angle,s));
            s.lastShot=t;
          }
        }

        for(let b of game.bullets){b.x+=b.vx*0.016;b.y+=b.vy*0.016;b.life+=0.016;wrap(b);}
        game.bullets=game.bullets.filter(b=>b.life<b.maxLife);

        for(let a of game.asteroids){a.x+=a.vx*0.016;a.y+=a.vy*0.016;wrap(a);}

        // collisions bullets vs asteroids
        for(let i=game.asteroids.length-1;i>=0;i--){let a=game.asteroids[i];
          for(let j=game.bullets.length-1;j>=0;j--){let b=game.bullets[j];
            let dx=a.x-b.x,dy=a.y-b.y;if(dx*dx+dy*dy<(a.radius+b.radius)**2){
              game.asteroids.splice(i,1);game.bullets.splice(j,1);game.score+=20;updateHUD();
              if(Math.random()<0.2){let types=['life','rapid','shield'];let type=types[Math.floor(Math.random()*types.length)];game.powerups.push(makePowerup(a.x,a.y,type));}
              break;
            }
          }
        }

        // collisions ship vs asteroids
        for(let a of game.asteroids){let dx=a.x-s.x,dy=a.y-s.y;if(dx*dx+dy*dy<(a.radius+s.radius)**2){
          if(s.shield<=0&&s.invincible<=0){game.lives--;updateHUD();s=game.ship=makeShip();s.invincible=2;}
        }}

        // powerups update
        for(let i=game.powerups.length-1;i>=0;i--){let p=game.powerups[i];p.x+=p.vx*0.016;p.y+=p.vy*0.016;wrap(p);p.life-=0.016;
          if(p.life<=0)game.powerups.splice(i,1);
          else{
            let dx=p.x-s.x,dy=p.y-s.y;if(dx*dx+dy*dy<(p.radius+s.radius)**2){
              if(p.type==='life')game.lives++;
              if(p.type==='rapid')s.rapid=6;
              if(p.type==='shield')s.shield=6;
              updateHUD();game.powerups.splice(i,1);
            }
          }
        }

        if(game.asteroids.length===0){game.level++;spawnWave();updateHUD();}
      }

      // draw ship
      if(game?.ship){ctx.save();ctx.translate(game.ship.x,game.ship.y);ctx.rotate(game.ship.angle);
        ctx.strokeStyle=game.ship.shield>0?'#0f0':'#fff';ctx.beginPath();ctx.moveTo(16,0);ctx.lineTo(-12,-10);ctx.lineTo(-6,0);ctx.lineTo(-12,10);ctx.closePath();ctx.stroke();ctx.restore();}
      // draw asteroids
      for(let a of game?.asteroids||[]){ctx.beginPath();ctx.arc(a.x,a.y,a.radius,0,TAU);ctx.strokeStyle='#888';ctx.stroke();}
      // draw bullets
      for(let b of game?.bullets||[]){ctx.beginPath();ctx.arc(b.x,b.y,2,0,TAU);ctx.fillStyle='#fff';ctx.fill();}
      // draw powerups
      for(let p of game?.powerups||[]){ctx.beginPath();ctx.arc(p.x,p.y,p.radius,0,TAU);ctx.fillStyle=p.type==='life'?'#0f0':(p.type==='rapid'?'#0ff':'#ff0');ctx.fill();}
    }
    requestAnimationFrame(loop);
  })();
  </script>
</body>
</html>
